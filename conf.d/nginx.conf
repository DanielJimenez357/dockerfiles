# Contenido SIMPLIFICADO para tu archivo conf.d/nginx.conf en GitHub

# Puedes dejar el map si lo usas para el index, o quitarlo si no.
map $http_accept_language $lang_suffix {
    default       ""; # Un valor por defecto es bueno
    ~*^es         ".es";  
    ~*^en         ".en";
}

server {
    listen 80;
    server_name CONTENEDORES.WORK.GD; # O _ para cualquier host si no configuras DNS

    # La raíz es /usr/share/nginx/html porque ahí montamos la carpeta 'web' del repo
    root /usr/share/nginx/html;

    # Define qué archivos buscar como índice
    # Si usas el map, asegúrate que los archivos index.es.html, index.en.html existan.
    # Si no, simplemente usa: index index.html index.htm;
    index index$lang_suffix.html index.html index.htm;

    autoindex on; # Si quieres ver el listado de archivos si no hay un index. Cuidado en producción.

    location / {
        try_files $uri $uri/ =404;
    }

    # Comentado para que no dependa de /paginaSiRedirigida.html si no lo tienes aún
    # location = /paginaNoRedirigida.html {
    #     return 301 /paginaSiRedirigida.html;
    # }

    # Opcional: Página de error personalizada
    error_page 404 /404.html; # Asumiendo que 404.html está en tu carpeta 'web/'
    location = /404.html {
        internal;
    }
}

# ---------------------------------------------------------------------------
# El siguiente bloque server para HTTPS está comentado porque requiere certificados
# y podría causar problemas si los archivos SSL no están montados.
# Descomenta y ajusta si tienes los certificados listos para ser montados.
# ---------------------------------------------------------------------------
# server {
#     listen 443 ssl http2;
#     listen [::]:443 ssl http2;
#     server_name CONTENEDORES.WORK.GD;

#     # NECESITARÍAS MONTAR ESTOS ARCHIVOS SSL EN EL POD
#     # ssl_certificate /etc/nginx/ssl/certificados.pem;
#     # ssl_certificate_key /etc/nginx/ssl/contenedores.work.gd.key;

#     root /usr/share/nginx/html; # Ajustado a la raíz correcta
#     index index$lang_suffix.html index.html index.htm;
#     autoindex on;

#     location / {
#         try_files $uri $uri/ =404;
#     }

#     # LOCATION TOMCAT COMENTADA
#     # location /tomcat/ {
#     #     proxy_pass http://tomcat:8080/sample/;
#     #     proxy_set_header Host $host;
#     #     proxy_set_header X-Real-IP $remote_addr;
#     #     proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#     #     proxy_set_header X-Forwarded-Proto $scheme;
#     # }

#     # LOCATION LDAP Y AUTH-PROXY COMENTADAS
#     # location /ldap/ {
#     #     auth_request /auth-proxy;
#     #     alias /var/www/sitio_protegido/;
#     #     index index.html;
#     #     try_files $uri $uri/ =404;
#     # }
#     # location = /auth-proxy {
#     #     internal;
#     #     proxy_pass http://apache:80/;
#     #     proxy_pass_request_body off;
#     #     proxy_set_header Content-Length "";
#     #     proxy_set_header X-Original-URI $request_uri;
#     #     proxy_set_header Authorization $http_authorization;
#     #     proxy_pass_header Authorization;
#     # }
# }